{"version":3,"file":"assetFile.js","sourceRoot":"","sources":["../../../src/components/assetFile.ts"],"names":[],"mappings":"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","sourcesContent":["import { css } from 'lit';\r\nimport { html, component, useState, useEffect } from 'haunted';\r\n\r\n// import * as pdfjslib from 'pdfjs-dist';\r\n// const PDFJS = (<any>pdfjslib) as PDFJSStatic;\r\n\r\nimport { useStyles } from '../hooks/useStyles';\r\n\r\nconst dummyData = '';\r\nfunction assetFile(\r\n  this: any,\r\n  { url = dummyData, alt = '' }: { url: string; alt: string }\r\n) {\r\n  useStyles(this, [css``]);\r\n  const [file, setFile] = useState(html`\r\n    <!-- <sl-responsive-media> -->\r\n    <p>Downloading file....</p>\r\n    <sl-spinner style=\"font-size: 3rem;\"></sl-spinner>\r\n    <!-- </sl-responsive-media> -->\r\n  `);\r\n\r\n  const fileMediaTypeCallback = (mediaType: string) => {\r\n    const event = new CustomEvent('media-type', {\r\n      bubbles: true,\r\n      composed: true,\r\n      detail: { type: mediaType },\r\n    });\r\n    this.dispatchEvent(event);\r\n  };\r\n\r\n  useEffect(async () => {\r\n    let response: Response | null = null;\r\n    setFile(html`\r\n      <!-- <sl-responsive-media> -->\r\n      <sl-spinner style=\"font-size: 3rem;\"></sl-spinner>\r\n      <p>Loading file....</p>\r\n      <!-- </sl-responsive-media> -->\r\n    `);\r\n    try {\r\n      response = await fetch(\r\n        url.replace('ipfs://', 'https://gateway.bakrypt.io/ipfs/')\r\n      );\r\n    } catch (error) {\r\n      console.log(error);\r\n      setFile(html`<p>Failed to load</p>`);\r\n    }\r\n\r\n    try {\r\n      if (response && !response.ok) {\r\n        setFile(html`\r\n          <!-- <sl-responsive-media> -->\r\n          <p>File not found.</p>\r\n          <!-- </sl-responsive-media> -->\r\n        `);\r\n      } else if (response && response.ok && response.body) {\r\n        // Get arrayBuffer\r\n        const mimeType = response.headers.get('Content-Type');\r\n\r\n        if (mimeType) fileMediaTypeCallback(mimeType);\r\n        if (mimeType?.includes('image')) {\r\n          setFile(html`\r\n            <!-- <sl-responsive-media> -->\r\n            <img\r\n              style=\"display: block; margin-bottom:1rem; object-fit: contain; width: 100% \"\r\n              slot=\"image\"\r\n              src=${url.replace('ipfs://', 'https://gateway.bakrypt.io/ipfs/')}\r\n              alt=${alt}\r\n            />\r\n            <!-- </sl-responsive-media> -->\r\n          `);\r\n        } else if (mimeType?.includes('video')) {\r\n          setFile(html`\r\n            <!-- <sl-responsive-media> -->\r\n            <video\r\n              style=\"display: block; margin-bottom:1rem; object-fit: contain; width: 100% \"\r\n              src=${url.replace('ipfs://', 'https://gateway.bakrypt.io/ipfs/')}\r\n              alt=${alt}\r\n              controls\r\n            ></video>\r\n            <!-- </sl-responsive-media> -->\r\n          `);\r\n        } else if (mimeType?.includes('audio')) {\r\n          setFile(html`\r\n            <!-- <sl-responsive-media> -->\r\n            <audio\r\n              style=\"display: block; margin-bottom:1rem; object-fit: contain; width: 100% \"\r\n              src=${url.replace('ipfs://', 'https://gateway.bakrypt.io/ipfs/')}\r\n              alt=${alt}\r\n              controls\r\n            ></audio>\r\n            <!-- </sl-responsive-media> -->\r\n          `);\r\n        }\r\n      }\r\n    } catch (error) {\r\n      console.log(error);\r\n      setFile(html`<p>Failed to load</p>`);\r\n    }\r\n  }, [url, alt]);\r\n\r\n  return file;\r\n}\r\n\r\nexport { assetFile };\r\n"]}